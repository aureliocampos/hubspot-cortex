<!--
    templateType: blog_listing
    isAvailableForNewContent: true
    label: Biblioteca Listagem
-->
{% extends "../layouts/base-materials.html" %}


{% choice "category_filter" label='Filtrar Categoria', value='type', 
choices='[
  ["comunicacao", "Comunicação"],
  ["marketing", "Marketing"],
  ["vendas", "Vendas"],
  ["inteligencia", "Inteligência"]
]', 
export_to_template_context=True 
%}

{% choice "material_type_filter" label='Filtrar tipo de material', value='type', 
choices='
  ["ebook", "eBook"],
  Meetup, 
  Caso de sucesso,
  Áudio Posts,
  Novidades Cortex,
  Guest Post,
  Infográficos
', 
export_to_template_context=True 
%}

{% choice "sector_filter" label='Filtrar Setor', value='type', 
choices='
  Financeiro, 
  Tecnologia
', 
export_to_template_context=True 
%}

{% require_css %}
<style>
  .filters {
    max-width: 1114px;
    margin: 4em auto;
  }
  .filters form {
    margin: 2em;
  }
  .filters form div {
    margin: 1em 0;
  }
  .filters form button {
    margin-top: 2em;
  }
  .section {
    max-width: 1114px;
    margin: 1em auto;
  }
</style>
{% end_require_css%}
{% block body %}
  <main id="main-content" class="body-container-wrapper" role="main">

    <div class="filters">
      <form action="" id="filter">
        {% for choice in widget_data.category_filter.choices_list %}
          <div>
            <input type="checkbox" name="category" id="{{ choice[0]|lower }}" value="{{ choice[0]|lower }}">
            <label for="{{ choice[0]|lower }}">
              {{ choice[1] }}
            </label>
          </div>
        {% endfor %}

        <div>
          <button type="submit" >Filtrar</button>
        </div>
      </form>
      <a href="{{ group.absolute_url }}" style="color: red;">Limpar filtro</a>

      <br>
      <br>
      <div>
        {% set categories = request.query|split("category=")|replace("&", "") %}
        {{ categories }}
      </div>
    </div>


    {% if categories != [] %}
      {% for content in contents %}
                                
        {% set type = content.widgets.module_16467570902134.body.categoria|lower %}
                            
        {% if categories is containing type %}
                                
          <div class="section">
            <div class="section__container">
              <article class="card-primary__article">
                {% if content.featured_image and group.use_featured_image_in_summary %}
                  <figure class="card-primary__figure">
                    <a href="{{content.link_rel_canonical_url}}">
                      <img 
                        data-src="{{ content.featured_image }}" 
                        data-srcset="{{ resize_image_url( content.featured_image, 345, 190, 345 ) }} 345w" 
                        sizes="345px" 
                        alt="{{ content.featured_image_alt_text }}"
                        class="lazyload card-primary__image"
                        width="345px"
                        height="190px"
                      />
                    </a>
                  </figure>
                {% endif %}
                <div class="card-primary__summary">
                  <a href="{{content.link_rel_canonical_url}}">
                    <h2 class="card-primary__name">{{ content.name }}</h2>
                    {% if content_group.show_summary_in_listing %}
                      <p class="card-primary__description">{{ content.meta_description }}</p>
                    {% endif %}
                  </a>
                  {% if content.tag_list != [] %}
                    {% for tag in content.topic_list %}
                      <a href="{{ blog_tag_url('default', tag.slug) }}" class="card-primary__tag">{{tag}}</a>
                    {% endfor %}       
                  {% endif %}
                </div>
              </article>
            </div>
          </div>
                                
        {% endif %}
      {% endfor %}                      
    {% else %}
      {% include "./partials/materials-listing.html" %}
    {% endif %}

  </main>
{% endblock body %}

{% require_js %}
  <!-- <script>
    // if (window.sessionStorage) {

    //   const inputsCategories = Array.from(document.querySelectorAll('input[name="category"]'))
    //   const inputsCategoriesisChecked = inputsCategories.filter(input => input.checked == true);

    //   inputsCategories.forEach( input => {
    //     input.addEventListener('change', (event) => {
    //       sessionStorage.setItem("inputsCategories", [
    //         {"vendas": true}, 
    //         {"marketing": false}
    //       ])
    //     })
    //   })
    // }

    document.querySelector('button[type="submit"]').addEventListener('click', event => {
      event.preventDefault();

      console.log("");
    })
  </script> -->
{% end_require_js%}